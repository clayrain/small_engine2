function wag(e){return document.getElementById(e)}function setupViewport(){for(i=0;i<animationlist.length;i++){var e=animationlist[i];var t=animation[e].target+"-vp";var n=animation[e].offsetY;wag(t).style.height=n+"px"}}function aniplayer(){var e=animation[pickani].frames;var t=animation[pickani].cframe;var n=animation[pickani].target;var r=animation[pickani].startX;var s=animation[pickani].startY;var o=animation[pickani].offsetX;var u=animation[pickani].offsetY;var a=animation[pickani].direction;var f=animation[pickani].wait;var l=animation[pickani].randomloop;var c=animation[pickani].cycle;switch(c){case"bounce":var h=t<e&&a==-1;if(!h){pause=animation[pickani].pause;if(a==-1){animation[pickani].pausecount=0}a=1;animation[pickani].direction=1;h=true}if(t==0&&a==1){h=false;a=-1;animation[pickani].direction=a;animation[pickani].cframe=1}break;case"walk":var p=wag(n).style.top;var d=wag(n).style.left;p=Number(p.replace("px",""));d=Number(d.replace("px",""));dx=Number(a)*Number(o);dx=d+dx;bound=animation[pickani].bound;boundArray=bound.split(",");if(dx<Number(boundArray[0])){dx=Number(boundArray[1])}if(dx>Number(boundArray[1])){dx=Number(boundArray[0])}wag(n).style.left=dx+"px";break;default:var h=t<e;break}if(h){switch(a){case-1:var v=u*t+s;wag(n).style.top=v*a+"px";animation[pickani].cframe=t+1;break;case 1:animation[pickani].pausecount+=anitick;if(animation[pickani].pausecount>=animation[pickani].pause){t-=1;animation[pickani].cframe=t-1;var v=u*t+s;wag(n).style.top=v*-1+"px";animation[pickani].cframe=t}break}}else{if(c!="walk"){wag(n).style.top=s*-1+"px"}animation[pickani].cframe=1;if(animation[pickani].loop!=animation[pickani].cloop){animation[pickani].cloop+=1}else{var m=0;if(animation[pickani].delay!=0){m=Math.floor(Math.random()*(animation[pickani].delay+1))}animation[pickani].waitcount=-1*m;animation[pickani].cloop=0;var g=animation[pickani].que;if(g!=""){index=animationorder.indexOf(pickani);if(index>-1){animationorder.splice(index,1)}currenttarget=animation[pickani].target;var y=[];for(i=0;i<animationlist.length;i++){var b=animationlist[i];newtarget=animation[b].target;if(newtarget==currenttarget){y.push(b)}}tempani_count=y.length;tempani_pick=Math.floor(Math.random()*tempani_count);animationorder.push(y[tempani_pick])}}}}function aniclock(){for(i=0;i<animationorder.length;i++){pickani=animationorder[i];if(animation[pickani].waitcount!=undefined){animation[pickani].waitcount+=anitick}else{animation[pickani].waitcount=anitick}if(animation[pickani].waitcount>=animation[pickani].wait){animation[pickani].waitcount=0;aniplayer()}}}function aniscene(e){currentscene=e;animationlist=[];animationorder=[];if(scenelist[e]){animationlist=scenelist[e].animationlist;animationorder=scenelist[e].animationorder}}function startani(){clearInterval(anitime);anitime=setInterval(aniclock,1e3*anitick)}function startanit(){clearInterval(anitimet);anitimet=setInterval(aniclock,1e3*anitick)}function stopani(){clearInterval(anitimet);clearInterval(anitime)}function dumpanimation(){animationorder=[]}function addaniobj(e){var t=e.split(",");animationorder=animationorder.concat(t);scenelist[whichscene].animateorder=animationorder}function addani(e){var t=e.split(",");animationorder=animationorder.concat(t)}function removeani(e){index=animationorder.indexOf(e);if(index>-1){var t=animation[e].target;var n=animation[e].startY;wag(t).style.top=n+"px";animationorder.splice(index,1)}}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(e,t){for(var n=t||0,r=this.length;n<r;n++){if(this[n]===e){return n}}return-1}}var scenelist={};var currentscene="";var anitime;var anitimet;var animationlist=[];var animationorder=[]